<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Land Value &amp; Property Market</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="top-bar">
  <a href="index.html" class="site-title">CS2 Modding Research</a>
  <span class="attribution">Generated with Claude | Supervised by repository owner</span>
</div>

<div class="page-layout">

    <aside class="sidebar">
    <h3>Events &amp; Simulation</h3>
    <a href="event-entity-archetype.html">Event Entity Archetype</a>
    <a href="fire-ignition.html">Fire Ignition</a>
    <a href="vehicle-out-of-control.html">Vehicle Accidents</a>
    <a href="crime-trigger.html">Crime Trigger</a>
    <a href="citizen-sickness.html">Citizen Sickness</a>
    <a href="water-system.html">Water System</a>
    <a href="emergency-dispatch.html">Emergency Dispatch</a>
    <a href="disaster-simulation.html">Disaster Simulation</a>

    <h3>Infrastructure</h3>
    <a href="electricity-grid.html">Electricity Grid</a>
    <a href="water-sewage-pipes.html">Water &amp; Sewage Pipes</a>
    <a href="road-network.html">Road &amp; Network Building</a>
    <a href="zoning.html">Zoning</a>
    <a href="pathfinding.html">Pathfinding</a>
    <a href="traffic-flow.html">Traffic Flow</a>

    <h3>Economy &amp; Population</h3>
    <a href="citizens-households.html">Citizens &amp; Households</a>
    <a href="economy-budget.html">Economy &amp; Budget</a>
    <a href="demand-systems.html">Demand Systems</a>
    <a href="resource-production.html">Resource Production</a>
    <a href="company-simulation.html">Company Simulation</a>
    <a href="workplace-labor.html">Workplace &amp; Labor</a>
    <a href="land-value-property.html" class="active">Land Value &amp; Property</a>
    <a href="trade-connections.html">Trade &amp; Connections</a>
    <a href="tourism-economy.html">Tourism Economy</a>
    <a href="cargo-transport.html">Cargo Transport</a>

    <h3>City Services</h3>
    <a href="garbage-collection.html">Garbage Collection</a>
    <a href="education.html">Education</a>
    <a href="public-transit.html">Public Transit</a>
    <a href="healthcare.html">Healthcare</a>
    <a href="deathcare.html">Deathcare</a>
    <a href="parks-recreation.html">Parks &amp; Recreation</a>
    <a href="police-dispatch.html">Police Dispatch</a>

    <h3>Governance</h3>
    <a href="districts-policies.html">Districts &amp; Policies</a>
    <a href="map-tile-purchase.html">Map Tile Purchase</a>

    <h3>Environment</h3>
    <a href="weather-climate.html">Weather &amp; Climate</a>
    <a href="pollution.html">Pollution</a>
    <a href="terrain-resources.html">Terrain &amp; Resources</a>

    <h3>Vehicles &amp; Transport</h3>
    <a href="vehicle-spawning.html">Vehicle Spawning</a>

    <h3>Tools &amp; Input</h3>
    <a href="tool-activation.html">Tool Activation</a>
    <a href="tool-raycast.html">Tool Raycast</a>
    <a href="input-action-lifecycle.html">Input Action Lifecycle</a>
    <a href="mod-hotkey-input.html">Mod Hotkey Input</a>
    <a href="object-tool-system.html">Object Placement Tool</a>

    <h3>UI &amp; Settings</h3>
    <a href="mod-ui-buttons.html">Mod UI Buttons</a>
    <a href="mod-options-ui.html">Mod Options UI</a>
    <a href="info-views-overlays.html">Info Views &amp; Overlays</a>
    <a href="chirper-notifications.html">Chirper Notifications</a>

    <h3>Modding Framework</h3>
    <a href="save-load-persistence.html">Save/Load Persistence</a>
    <a href="prefab-system.html">Prefab System</a>
    <a href="localization.html">Localization</a>
    <a href="harmony-transpilers.html">Harmony Transpilers</a>
    <a href="mod-loading-dependencies.html">Mod Loading</a>
  </aside>

  <main class="content">

  <h1>Land Value &amp; Property Market</h1>

  <div class="scope">
    <h2>Scope</h2>
    <p>
      <strong>Question:</strong> How does CS2 calculate land value across the map, determine rent
      prices for buildings, process rent payments from households and companies, and drive the
      building level-up and level-down lifecycle?
    </p>
    <p>
      <strong>Verdict:</strong> Land value is computed in two layers: per-road-edge values driven by
      <strong>service coverage</strong> (health, education, police, transit) and <strong>resource availability</strong>
      (commercial services), then aggregated into a <strong>128x128 cell map</strong> that blends edge values
      with terrain attractiveness, telecom coverage, and pollution penalties. Rent is calculated from
      land value using the formula: <code>(landValue * zoneModifier + baseRate * level) * lotSize * spaceMultiplier / renterCount</code>.
      Building condition accumulates based on whether renters can afford upkeep, driving a
      <strong>level-up</strong> (resource delivery + prefab swap) or <strong>level-down</strong> (abandonment) lifecycle.
    </p>
    <p>
      <strong>Out of scope:</strong> Company profitability details are in
      <a href="company-simulation.html">Company Simulation</a>. Household happiness and citizen
      income are in <a href="citizens-households.html">Citizens &amp; Households</a>.
    </p>
  </div>

  <!-- ============================================================ -->
  <h2>How It Works</h2>

  <p>
    The property market in CS2 connects several interconnected systems: land value computation
    determines how desirable a location is, rent prices translate that desirability into costs,
    rent payments transfer money from renters to upkeep, and building condition tracks whether
    a building is improving (toward level-up) or deteriorating (toward abandonment).
  </p>

  <h3>Land Value: Two-Layer Computation</h3>

  <p>
    Land value is computed in two passes by <code>LandValueSystem</code>, which runs 32 times per
    game day:
  </p>

  <h4>Layer 1: Edge Values (per road segment)</h4>

  <p>
    The <code>EdgeUpdateJob</code> runs on every road edge that has a <code>LandValue</code> component.
    It sums weighted bonuses from six factors:
  </p>

  <ul>
    <li><strong>Health coverage</strong> (index 0 in ServiceCoverage buffer) -- multiplied by 5.0</li>
    <li><strong>Education coverage</strong> (index 5) -- multiplied by 5.0</li>
    <li><strong>Police coverage</strong> (index 2) -- multiplied by 5.0</li>
    <li><strong>Commercial services</strong> (index 1 in ResourceAvailability buffer) -- multiplied by 10.0</li>
    <li><strong>Bus access</strong> (index 31 in ResourceAvailability) -- multiplied by 5.0</li>
    <li><strong>Tram/subway access</strong> (index 32 in ResourceAvailability) -- multiplied by 50.0</li>
  </ul>

  <p>
    Each service coverage is averaged between the start and end of the edge segment
    (<code>lerp(coverage.x, coverage.y, 0.5)</code>). The result is smoothed toward the target
    at a lerp rate of <strong>0.6</strong>, ensuring land value changes gradually rather than
    jumping instantly.
  </p>

  <h4>Layer 2: Cell Map (128x128 grid)</h4>

  <p>
    The <code>LandValueMapUpdateJob</code> processes each cell in the 128x128 grid. For each cell:
  </p>

  <ol>
    <li>If underwater (depth &gt; 1m), set to baseline value (10.0) and skip</li>
    <li>Search nearby road edges within 1.5 cell widths using a quad tree</li>
    <li>Average the <code>LandValue.m_LandValue</code> of nearby edges</li>
    <li>Add bonuses: attractiveness (AvailabilityInfo * 3.0), telecom quality (* 20.0), terrain attractiveness (* 3.0) -- each capped at 100</li>
    <li>Terrain attractiveness only applies if there is no water pollution and no ground pollution at the cell</li>
    <li>Subtract penalties: ground pollution (* 10.0), air pollution (* 5.0), noise (* 0.01)</li>
    <li>Floor at baseline value (10.0)</li>
    <li>Smooth toward target at lerp rate <strong>0.4</strong></li>
  </ol>

  <h3>Rent Calculation</h3>

  <p>
    The <code>RentAdjustSystem</code> runs 16 times per day and recalculates rent for every
    occupied building. The core formula lives in <code>PropertyUtils.GetRentPricePerRenter()</code>:
  </p>

  <pre><code class="language-csharp">// Simplified rent formula
float totalRent;
if (ignoreLandValue)
    totalRent = baseRate * level * lotSize * spaceMultiplier;
else
    totalRent = (landValue * zoneModifier + baseRate * level) * lotSize * spaceMultiplier;

int renterCount = IsMixedBuilding ? adjusted : countProperties;
int rentPerRenter = Round(totalRent / renterCount);</code></pre>

  <p>Where:</p>

  <ul>
    <li><strong>landValue</strong> = <code>LandValue.m_LandValue</code> from the building's road edge</li>
    <li><strong>zoneModifier</strong> = <code>EconomyParameterData.m_LandValueModifier</code> (per zone type: x=residential, y=commercial, z=industrial)</li>
    <li><strong>baseRate</strong> = <code>EconomyParameterData.m_RentPriceBuildingZoneTypeBase</code> (per zone type)</li>
    <li><strong>level</strong> = building level from <code>SpawnableBuildingData.m_Level</code></li>
    <li><strong>lotSize</strong> = <code>BuildingData.m_LotSize.x * m_LotSize.y</code></li>
    <li><strong>spaceMultiplier</strong> = <code>BuildingPropertyData.m_SpaceMultiplier</code></li>
  </ul>

  <h3>Rent Payment and Renter Decisions</h3>

  <p>
    After rent is calculated, two systems handle the consequences:
  </p>

  <h4>RentAdjustSystem: Income Comparison</h4>

  <p>
    For each renter, the system compares rent + garbage fee against income:
  </p>

  <ul>
    <li><strong>Households</strong>: income = sum of worker wages + current savings</li>
    <li><strong>Companies</strong>: income = max of (company max profit per day, company total worth)</li>
  </ul>

  <p>
    Based on this comparison:
  </p>

  <ul>
    <li>If <code>rent + garbageFee &gt; income</code>: the renter becomes a <strong>PropertySeeker</strong> -- it starts looking for cheaper property</li>
    <li>If <code>rent + garbageFee &lt; income / 2</code> (households only): the renter also becomes a PropertySeeker -- it can afford better</li>
    <li>If &gt;70% of renters are overpaying and the building has vacancies: a <strong>high rent warning</strong> icon appears</li>
  </ul>

  <h4>PropertyRenterSystem: Actual Payment</h4>

  <p>
    The <code>PayRentJob</code> deducts money from each renter:
  </p>

  <ul>
    <li>Regular renters pay: <code>rent / kUpdatesPerDay</code> (1/16 of daily rent per tick)</li>
    <li>Storage companies pay their entire money balance as rent</li>
    <li>Garbage fee is split equally among all renters</li>
    <li>Invalid renters (no PropertyRenter component) are removed from the building</li>
    <li>Vacant buildings are put back on market (<code>PropertyToBeOnMarket</code>)</li>
  </ul>

  <h3>Building Level-Up and Level-Down</h3>

  <p>
    The <code>BuildingUpkeepSystem</code> manages building condition through a straightforward
    accumulator model:
  </p>

  <h4>Condition Change</h4>

  <p>
    Each tick (16x per day), the system:
  </p>

  <ol>
    <li>Reads building upkeep from <code>ConsumptionData.m_Upkeep</code></li>
    <li>Splits into material upkeep (1/4) and monetary upkeep (3/4)</li>
    <li>Sums total renter wealth (household money or company total worth)</li>
    <li>If renters can afford the monetary portion: <strong>condition increases</strong></li>
    <li>If renters cannot afford it: <strong>condition decreases</strong></li>
    <li>Change magnitude scales with: <code>conditionChange * pow(2, level) * max(1, renterCount)</code></li>
  </ol>

  <p>
    The <strong>exponential level scaling</strong> is significant: a level-3 building accumulates
    condition changes 8x faster than a level-1 building (<code>pow(2, 3) = 8</code>), and a level-5
    building accumulates 32x faster. This applies in both directions -- well-funded high-level
    buildings level up faster, but underfunded ones deteriorate and reach abandonment faster too.
    The <code>conditionChange</code> base value comes from <code>BuildingUtils.GetBuildingConditionChange()</code>,
    and the <code>levelingCost</code> and <code>abandonCost</code> thresholds also scale with building
    properties via <code>BuildingUtils.GetLevelingCost()</code> and <code>BuildingUtils.GetAbandonCost()</code>,
    which factor in area type, lot size, and current level.
  </p>

  <h4>Level-Up Trigger</h4>

  <p>
    When <code>BuildingCondition.m_Condition &gt;= levelingCost</code>:
  </p>

  <ol>
    <li>System adds a <code>ResourceNeeding</code> buffer requesting level-up materials</li>
    <li>Creates <code>GoodsDeliveryRequest</code> service requests for each material</li>
    <li>Shows a "leveling" notification icon</li>
    <li>When all materials are delivered: <code>LevelupJob</code> selects a new building prefab at level+1 with matching zone type, lot size, and access flags</li>
    <li>Adds <code>UnderConstruction</code> component to trigger the visual upgrade</li>
  </ol>

  <h4>Level-Down (Abandonment)</h4>

  <p>
    When <code>BuildingCondition.m_Condition &lt;= -abandonCost</code> (and building is not a signature building):
  </p>

  <ol>
    <li>Removes utility consumers (electricity, water, garbage, mail, telecom)</li>
    <li>Doubles crime production: <code>CrimeProducer.m_Crime *= 2f</code></li>
    <li>Clears <code>BuildingFlags.HighRentWarning</code> and removes the high-rent notification icon</li>
    <li>Removes all problem/fatal-problem icons, adds <code>m_AbandonedNotification</code> at <code>IconPriority.FatalProblem</code></li>
    <li>Evicts all renters (iterates <code>Renter</code> buffer in reverse, removes <code>PropertyRenter</code> from each)</li>
    <li>Enqueues utility road edge updates for electricity and water pipe networks</li>
    <li>Emits trigger actions: <code>LevelDownCommercialBuilding</code>, <code>LevelDownIndustrialBuilding</code> (if not office), or <code>LevelDownOfficeBuilding</code>. Note: no residential level-down trigger exists.</li>
    <li>Adds <code>Abandoned</code> component with <code>m_AbandonmentTime = currentSimulationFrame</code></li>
  </ol>

  <!-- ============================================================ -->
  <h2>Key Components</h2>

  <table>
    <thead>
      <tr><th>Assembly</th><th>Namespace</th><th>What's There</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>Game.dll</td>
        <td>Game.Net</td>
        <td>LandValue (per-edge land value component)</td>
      </tr>
      <tr>
        <td>Game.dll</td>
        <td>Game.Simulation</td>
        <td>LandValueSystem, LandValueCell, PropertyRenterSystem, RentAdjustSystem, BuildingUpkeepSystem, PropertyRenterRemoveSystem</td>
      </tr>
      <tr>
        <td>Game.dll</td>
        <td>Game.Buildings</td>
        <td>PropertyRenter, Renter (buffer), RentAction, RentersUpdated, PropertyOnMarket, BuildingCondition, PropertyUtils, ResourceNeeding, GoodsDeliveryRequest</td>
      </tr>
      <tr>
        <td>Game.dll</td>
        <td>Game.Prefabs</td>
        <td>LandValueParameterData, LandValuePrefab, BuildingPropertyData, BuildingConfigurationData, ZoneLevelUpResourceData, SignatureBuildingData, SpawnableBuildingData, ZoneData, EconomyParameterData</td>
      </tr>
      <tr>
        <td>Game.dll</td>
        <td>Game.Vehicles</td>
        <td>DeliveryTruck, DeliveryTruckFlags</td>
      </tr>
    </tbody>
  </table>

  <h3>LandValue (Game.Net)</h3>

  <p>Per-edge component on road segments. The primary value used for rent calculation.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_LandValue</td><td>float</td><td>Computed land value at this road edge -- sum of service coverage and resource availability bonuses</td></tr>
      <tr><td>m_Weight</td><td>float</td><td>Weighting factor (serialized but not actively consumed by land value systems)</td></tr>
    </tbody>
  </table>

  <h3>LandValueCell (Game.Simulation)</h3>

  <p>Cell in the 128x128 land value grid. Used for the infoview overlay and general area queries.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_LandValue</td><td>float</td><td>Interpolated value combining nearby edge values, attractiveness, telecom, and pollution</td></tr>
    </tbody>
  </table>

  <h3>PropertyRenter (Game.Buildings)</h3>

  <p>On households and companies that rent a property unit.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_Property</td><td>Entity</td><td>The building entity being rented</td></tr>
      <tr><td>m_Rent</td><td>int</td><td>Current daily rent amount</td></tr>
    </tbody>
  </table>

  <h3>Renter (Game.Buildings)</h3>

  <p>Dynamic buffer on building entities listing occupants.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_Renter</td><td>Entity</td><td>Household or company entity renting this building</td></tr>
    </tbody>
  </table>

  <h3>PropertyOnMarket (Game.Buildings)</h3>

  <p>Added to buildings with vacant units. Property seekers evaluate these buildings.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_AskingRent</td><td>int</td><td>Advertised rent price for vacant units</td></tr>
    </tbody>
  </table>

  <h3>BuildingCondition (Game.Buildings)</h3>

  <p>Tracks building maintenance state. Drives leveling decisions.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_Condition</td><td>int</td><td>Accumulator: positive = well-maintained (toward level-up), negative = neglected (toward abandonment)</td></tr>
    </tbody>
  </table>

  <h3>BuildingPropertyData (Game.Prefabs)</h3>

  <p>Prefab component defining building capacity and allowed resources.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_ResidentialProperties</td><td>int</td><td>Number of residential units (apartments)</td></tr>
      <tr><td>m_AllowedSold</td><td>Resource</td><td>Resources that can be sold (commercial)</td></tr>
      <tr><td>m_AllowedInput</td><td>Resource</td><td>Resources allowed as production inputs</td></tr>
      <tr><td>m_AllowedManufactured</td><td>Resource</td><td>Resources that can be manufactured (industrial)</td></tr>
      <tr><td>m_AllowedStored</td><td>Resource</td><td>Resources that can be stored</td></tr>
      <tr><td>m_SpaceMultiplier</td><td>float</td><td>Space factor for rent calculation -- larger buildings have higher values</td></tr>
    </tbody>
  </table>

  <h3>LandValueParameterData (Game.Prefabs)</h3>

  <p>Global singleton controlling all land value computation weights.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Default</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_LandValueBaseline</td><td>10.0</td><td>Minimum land value floor everywhere</td></tr>
      <tr><td>m_HealthCoverageBonusMultiplier</td><td>5.0</td><td>Weight for healthcare service coverage</td></tr>
      <tr><td>m_EducationCoverageBonusMultiplier</td><td>5.0</td><td>Weight for education service coverage</td></tr>
      <tr><td>m_PoliceCoverageBonusMultiplier</td><td>5.0</td><td>Weight for police service coverage</td></tr>
      <tr><td>m_AttractivenessBonusMultiplier</td><td>3.0</td><td>Weight for terrain/tourism attractiveness</td></tr>
      <tr><td>m_TelecomCoverageBonusMultiplier</td><td>20.0</td><td>Weight for internet/telecom coverage</td></tr>
      <tr><td>m_CommercialServiceBonusMultiplier</td><td>10.0</td><td>Weight for nearby commercial services</td></tr>
      <tr><td>m_BusBonusMultiplier</td><td>5.0</td><td>Weight for bus transit accessibility</td></tr>
      <tr><td>m_TramSubwayBonusMultiplier</td><td>50.0</td><td>Weight for tram/subway accessibility</td></tr>
      <tr><td>m_CommonFactorMaxBonus</td><td>100</td><td>Per-factor bonus cap</td></tr>
      <tr><td>m_GroundPollutionPenaltyMultiplier</td><td>10.0</td><td>Ground pollution penalty weight</td></tr>
      <tr><td>m_AirPollutionPenaltyMultiplier</td><td>5.0</td><td>Air pollution penalty weight</td></tr>
      <tr><td>m_NoisePollutionPenaltyMultiplier</td><td>0.01</td><td>Noise pollution penalty weight</td></tr>
    </tbody>
  </table>

  <h3>RentAction (Game.Buildings)</h3>

  <p>Queue entry for pending move-in/move-out actions.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_Property</td><td>Entity</td><td>Target building</td></tr>
      <tr><td>m_Renter</td><td>Entity</td><td>Household or company moving in/out</td></tr>
      <tr><td>m_Flags</td><td>RentActionFlags</td><td>Storage (1) = storage company, Remove (2) = eviction</td></tr>
    </tbody>
  </table>

  <h3>RentersUpdated (Game.Buildings)</h3>

  <p>Tag component added as an event entity when renters change on a building.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_Property</td><td>Entity</td><td>The building whose renters list changed</td></tr>
    </tbody>
  </table>

  <h3>BuildingConfigurationData (Game.Prefabs)</h3>

  <p>Global singleton controlling building condition and level-up configuration.</p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_BuildingConditionDecrement</td><td>int</td><td>Base condition decrement per tick when building cannot afford upkeep</td></tr>
      <tr><td>m_AbandonedNotification</td><td>Entity</td><td>Notification prefab entity displayed when a building is abandoned</td></tr>
      <tr><td>m_HighRentNotification</td><td>Entity</td><td>Notification prefab entity displayed when &gt;70% of renters overpay</td></tr>
    </tbody>
  </table>

  <h3>ZoneLevelUpResourceData (Game.Prefabs, buffer)</h3>

  <p>
    Buffer element on zone prefab entities defining per-level resource requirements for building
    level-ups. Each zone type prefab (residential, commercial, industrial) has a buffer of these
    elements specifying which resources must be delivered at each level threshold. The
    <code>ResourceNeedingUpkeepJob</code> reads these entries to populate the
    <code>ResourceNeeding</code> buffer on buildings that have crossed the <code>levelingCost</code>
    condition threshold.
  </p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_Level</td><td>int</td><td>The building level this entry applies to</td></tr>
      <tr><td>m_LevelUpResource</td><td>Resource</td><td>The resource type required to level up to this level</td></tr>
    </tbody>
  </table>

  <!-- ============================================================ -->
  <h2>BuildingUpkeepSystem Deep Dive</h2>

  <p>
    <code>Game.Simulation.BuildingUpkeepSystem</code> is a large system (~103KB decompiled) handling
    building condition, level-up/level-down, resource consumption, and upkeep payments. It operates
    as a scheduled update with the following responsibilities:
  </p>

  <ol>
    <li><strong>Building upkeep payments</strong> -- deducting maintenance costs from building resources</li>
    <li><strong>Level-up logic</strong> -- buildings upgrade when conditions are met (land value, services, etc.)</li>
    <li><strong>Level-down logic</strong> -- buildings downgrade when conditions deteriorate</li>
    <li><strong>Resource delivery</strong> -- requesting electricity, water, and material deliveries</li>
    <li><strong>Level-up material tracking</strong> -- buildings need specific resources to level up</li>
  </ol>

  <h3>Key System Dependencies</h3>

  <table>
    <thead>
      <tr><th>System</th><th>Role</th></tr>
    </thead>
    <tbody>
      <tr><td>SimulationSystem</td><td>Frame timing</td></tr>
      <tr><td>ClimateSystem</td><td>Heating multiplier for resource consumption</td></tr>
      <tr><td>ResourceSystem</td><td>Resource availability</td></tr>
      <tr><td>CitySystem</td><td>City-level state</td></tr>
      <tr><td>IconCommandSystem</td><td>Level-up/down notification icons</td></tr>
      <tr><td>TriggerSystem</td><td>Event triggers</td></tr>
      <tr><td>ZoneBuiltRequirementSystem</td><td>Zone completion checks</td></tr>
      <tr><td>ZoneSearchSystem</td><td>Zone lookup</td></tr>
      <tr><td>ElectricityRoadConnectionGraphSystem</td><td>Power grid connectivity</td></tr>
      <tr><td>WaterPipeRoadConnectionGraphSystem</td><td>Water network connectivity</td></tr>
      <tr><td>CityProductionStatisticSystem</td><td>Production stats</td></tr>
    </tbody>
  </table>

  <h3>Key Components Read/Written</h3>

  <ul>
    <li><code>BuildingCondition</code> (Game.Buildings) -- read/write for condition tracking</li>
    <li><code>Efficiency</code> (Game.Buildings, IBufferElementData) -- read/write for building efficiency factors</li>
    <li><code>ResourceNeeding</code> (Game.Buildings) -- write to request level-up materials</li>
    <li><code>GoodsDeliveryRequest</code> (Game.Simulation) -- write to trigger material delivery trucks</li>
  </ul>

  <p>
    <strong>Modding note:</strong> The tight coupling of BuildingUpkeepSystem means it cannot be
    easily patched with Harmony -- community mods (RealisticWorkplacesAndHouseholds, UrbanInequality)
    fully replace it with <code>Enabled = false</code> and a custom system.
  </p>

  <!-- ============================================================ -->
  <h2>Advanced Patterns</h2>

  <h3>Education/Income-Based Building Leveling Penalty</h3>

  <p>
    A mod can compute custom leveling penalty multipliers by reading per-building citizen data.
    The pattern traverses from building to individual citizen attributes:
  </p>

  <ol>
    <li>Read the <code>Renter</code> buffer on the building entity to get all renter entities</li>
    <li>For each renter (household), read the <code>HouseholdCitizen</code> buffer to get citizen entities</li>
    <li>For each citizen, call <code>Citizen.GetEducationLevel()</code> and <code>Citizen.GetAge()</code> to read education and demographics</li>
    <li>Read the renter's <code>Resources</code> buffer and call <code>EconomyUtils.GetResources(Resource.Money)</code> to get household wealth</li>
    <li>Aggregate education levels and income across all building occupants to compute a custom penalty multiplier</li>
  </ol>

  <p>
    This enables mods like UrbanInequality that penalize or boost leveling speed based on the actual
    education profile and income distribution of a building's residents, rather than using the vanilla
    flat condition scaling.
  </p>

  <h3>Building Level Cap Distribution</h3>

  <p>
    Query buildings to enforce level distribution caps or gate level-ups by zone type:
  </p>

  <ol>
    <li>Query entities with <code>BuildingCondition</code> + <code>PrefabRef</code> + <code>UpdateFrame</code> (matching the vanilla update frame pattern)</li>
    <li>Read <code>SpawnableBuildingData.m_Level</code> from the prefab to get the current building level</li>
    <li>Read <code>ZoneData.m_AreaType</code> from the zone prefab to categorize by residential/commercial/industrial</li>
    <li>Count buildings per level per zone type to build a distribution histogram</li>
    <li>Gate level-ups by checking if the target level's count exceeds a configured cap before allowing <code>BuildingCondition</code> to cross the <code>levelingCost</code> threshold</li>
  </ol>

  <p>
    This pattern allows mods to enforce realistic level distributions (e.g., limiting the number
    of level-5 buildings city-wide) rather than allowing unrestricted leveling.
  </p>

  <h3>BuildingUpkeepSystem as Replacement Target</h3>

  <p>
    Both the RealisticWorkplaceHouseholds and UrbanInequality community mods independently replace
    <code>BuildingUpkeepSystem</code> with custom implementations. This confirms
    <code>BuildingUpkeepSystem</code> as a high-value system replacement target for mods that need
    to alter building condition logic, leveling thresholds, or abandonment behavior. Replacing rather
    than patching is preferred here because the system's inner jobs (<code>BuildingUpkeepJob</code>,
    <code>ResourceNeedingUpkeepJob</code>, <code>LevelupJob</code>, <code>LeveldownJob</code>) are
    Burst-compiled and cannot be directly Harmony-patched.
  </p>

  <h3>Level-Up Material Delivery Pipeline</h3>

  <p>
    When <code>BuildingCondition.m_Condition</code> crosses the <code>levelingCost</code> threshold,
    the system initiates a material delivery request before the actual level-up occurs:
  </p>

  <ol>
    <li><strong>ResourceNeeding</strong> (buffer on building entity): Each element defines a required
    resource delivery.
      <ul>
        <li><code>m_Resource</code> (Resource): The resource type needed</li>
        <li><code>m_Amount</code> (int): The amount required</li>
        <li><code>m_Flags</code> (ResourceNeedingFlags): Tracks delivery state -- <code>Requested</code> when a delivery truck has been dispatched, <code>Delivered</code> when the resource has arrived</li>
      </ul>
    </li>
    <li><strong>GoodsDeliveryRequest</strong> (component): Created to dispatch a delivery truck for the needed resource.
      <ul>
        <li><code>m_ResourceNeeder</code> (Entity): The building entity requesting the resource</li>
        <li><code>m_Amount</code> (int): The amount to deliver</li>
        <li><code>m_Resource</code> (Resource): The resource type to deliver</li>
      </ul>
    </li>
    <li><strong>Delivery-complete check flow</strong>: <code>ResourceNeedingUpkeepJob</code> iterates
    the <code>ResourceNeeding</code> buffer and checks if all elements have the <code>Delivered</code>
    flag set. Only when every required resource has been delivered does the system queue the actual
    <code>LevelupJob</code> to select a higher-level prefab and begin construction.</li>
  </ol>

  <h3>Signature Building Immunity</h3>

  <p>
    <code>SignatureBuildingData</code> (Game.Prefabs) acts as an immunity flag for signature and
    landmark buildings. When <code>BuildingUpkeepJob</code> processes a building, it checks for
    <code>SignatureBuildingData</code> on the building's prefab. Buildings with this component skip
    the level-down and abandonment checks entirely -- they never accumulate negative condition or
    receive the <code>Abandoned</code> component regardless of renter wealth or upkeep shortfalls.
  </p>

  <h3>Delivery Truck Upkeep State</h3>

  <p>
    The <code>Game.Vehicles.DeliveryTruck</code> component tracks delivery truck state including
    upkeep deliveries:
  </p>

  <table>
    <thead>
      <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr><td>m_State</td><td>DeliveryTruckFlags</td><td>Current truck state flags</td></tr>
      <tr><td>m_Resource</td><td>Resource</td><td>Resource being transported</td></tr>
      <tr><td>m_Amount</td><td>int</td><td>Amount being transported</td></tr>
    </tbody>
  </table>

  <p>
    The <code>DeliveryTruckFlags.UpkeepDelivery</code> flag identifies trucks delivering upkeep
    materials for building level-ups (as opposed to commercial/industrial resource deliveries).
    When a delivery request becomes stale (e.g., the target building was demolished or abandoned
    before delivery), the system performs cleanup by removing the <code>GoodsDeliveryRequest</code>
    component and resetting the corresponding <code>ResourceNeeding</code> entry's
    <code>Requested</code> flag, freeing the truck for reassignment.
  </p>

  <h3>Zone Type Detection and Tenant WorkProvider Access</h3>

  <p>
    <code>BuildingPropertyData.CountProperties(AreaType)</code> returns the number of properties
    (units) for a given zone type. This is the standard method for determining what zone type a
    building serves -- it checks the residential, commercial, and industrial property counts internally.
  </p>

  <p>
    To find <code>WorkProvider</code> components on building tenants, iterate the <code>Renter</code>
    buffer on the building entity and check each renter for the <code>WorkProvider</code> component:
  </p>

  <pre><code class="language-csharp">DynamicBuffer&lt;Renter&gt; renters = EntityManager.GetBuffer&lt;Renter&gt;(building, isReadOnly: true);
for (int i = 0; i &lt; renters.Length; i++)
{
    Entity renter = renters[i].m_Renter;
    if (EntityManager.HasComponent&lt;WorkProvider&gt;(renter))
    {
        WorkProvider wp = EntityManager.GetComponentData&lt;WorkProvider&gt;(renter);
        // Access wp.m_MaxWorkers, etc.
    }
}</code></pre>

  <p>
    This pattern is used by systems that need to aggregate employment data across all companies in a
    building (e.g., for computing building-level efficiency or worker density).
  </p>

  <!-- ============================================================ -->
  <h2>Data Flow</h2>

  <div class="diagram">
<pre>
LAND VALUE CALCULATION (32x per game day)
  LandValueSystem.EdgeUpdateJob
    For each road edge with LandValue component:
      health * 5.0 + education * 5.0 + police * 5.0
      + commercial * 10.0 + bus * 5.0 + tram/subway * 50.0
      LandValue.m_LandValue = lerp(current, sum, 0.6)
          |
          v
  LandValueSystem.LandValueMapUpdateJob
    For each cell in 128x128 grid:
      avg nearby edge values (within 1.5 cells)
      + attractiveness bonus (capped 100)
      + telecom bonus (capped 100)
      + terrain attractiveness (capped 100, only if no pollution)
      - ground_pollution * 10 - air_pollution * 5 - noise * 0.01
      floor at baseline (10.0)
      LandValueCell = lerp(current, target, 0.4)
          |
          v
RENT PRICING (16x per day)
  RentAdjustSystem.AdjustRentJob
    For each building:
      landValue = Building.m_RoadEdge -&gt; LandValue.m_LandValue
      rent = (landValue * zoneModifier + baseRate * level)
             * lotSize * spaceMultiplier / renterCount
      -&gt; PropertyRenter.m_Rent = rent
      -&gt; PropertyOnMarket.m_AskingRent = rent
      Compare rent vs income:
        rent &gt; income   -&gt; enable PropertySeeker (find cheaper)
        rent &lt; income/2 -&gt; enable PropertySeeker (find better)
        &gt;70% overpaying -&gt; HighRentWarning icon
          |
          v
RENT PAYMENT (16x per day)
  PropertyRenterSystem.PayRentJob
    renter.Money -= rent / 16
    renter.Money -= garbageFee / renterCount / 16
    Remove invalid renters
    Vacant buildings -&gt; PropertyToBeOnMarket
          |
          v
BUILDING CONDITION (16x per day)
  BuildingUpkeepSystem.BuildingUpkeepJob
    upkeep = ConsumptionData.m_Upkeep / 16
    monetary = upkeep * 3/4, material = upkeep * 1/4
    levelScale = pow(2, level) * max(1, renters)   // exponential!
    renterWealth &gt;= monetary?
      YES: condition += conditionChange * levelScale
           Deduct upkeep from each renter
      NO:  condition -= conditionChange * levelScale
    (Level-3 = 8x rate, Level-5 = 32x rate)
          |
          v
    condition &gt;= levelingCost
      Request level-up materials (GoodsDeliveryRequest)
      Materials delivered -&gt; LevelupJob
        Select higher-level prefab -&gt; UnderConstruction
          |
    condition &lt;= -abandonCost
      LeveldownJob -&gt; Abandoned
        Remove utilities, double CrimeProducer.m_Crime
        Clear HighRentWarning, evict renters (reverse)
        Add Abandoned{m_AbandonmentTime}, show icon
</pre>
  </div>

  <!-- ============================================================ -->
  <h2>Examples</h2>

  <h3>Read Land Value at a World Position</h3>

  <p>Sample the 128x128 land value cell map at any world coordinate.</p>

  <pre><code class="language-csharp">public partial class LandValueReaderSystem : GameSystemBase
{
    private LandValueSystem _landValueSystem;

    protected override void OnCreate()
    {
        base.OnCreate();
        _landValueSystem = World.GetOrCreateSystemManaged&lt;LandValueSystem&gt;();
    }

    protected override void OnUpdate()
    {
        float3 worldPos = new float3(500f, 0f, 300f);
        int cellIndex = LandValueSystem.GetCellIndex(worldPos);

        JobHandle deps;
        NativeArray&lt;LandValueCell&gt; map = _landValueSystem.GetMap(
            readOnly: true, out deps);
        deps.Complete();

        if (cellIndex &gt;= 0 &amp;&amp; cellIndex &lt; map.Length)
        {
            float landValue = map[cellIndex].m_LandValue;
            Log.Info($"Land value at {worldPos}: {landValue:F1}");
        }

        _landValueSystem.AddReader(Dependency);
    }
}</code></pre>

  <h3>Modify Land Value Parameters</h3>

  <p>Adjust the global land value singleton to rebalance the economy. For example, boost
  transit bonuses to incentivize public transport investment.</p>

  <pre><code class="language-csharp">public void AdjustLandValueParameters(EntityManager em)
{
    EntityQuery paramQuery = em.CreateEntityQuery(
        ComponentType.ReadWrite&lt;LandValueParameterData&gt;()
    );

    if (paramQuery.CalculateEntityCount() == 0) return;

    Entity paramEntity = paramQuery.GetSingletonEntity();
    LandValueParameterData data = em.GetComponentData&lt;LandValueParameterData&gt;(paramEntity);

    // Double transit bonuses
    data.m_TramSubwayBonusMultiplier = 100f;
    data.m_BusBonusMultiplier = 10f;

    // Reduce pollution penalties
    data.m_GroundPollutionPenaltyMultiplier = 5f;
    data.m_AirPollutionPenaltyMultiplier = 2.5f;

    em.SetComponentData(paramEntity, data);
    paramQuery.Dispose();
}</code></pre>

  <h3>Read a Building's Edge Land Value</h3>

  <p>Look up the land value at the road edge adjacent to a specific building. This is the
  value used directly in the rent formula.</p>

  <pre><code class="language-csharp">public float GetBuildingLandValue(EntityManager em, Entity building)
{
    if (!em.HasComponent&lt;Building&gt;(building))
        return 0f;

    Building buildingData = em.GetComponentData&lt;Building&gt;(building);
    Entity roadEdge = buildingData.m_RoadEdge;

    if (roadEdge == Entity.Null || !em.HasComponent&lt;LandValue&gt;(roadEdge))
        return 0f;

    LandValue landValue = em.GetComponentData&lt;LandValue&gt;(roadEdge);
    return landValue.m_LandValue;
}</code></pre>

  <h3>Override Rent Price via Harmony Postfix</h3>

  <p>Patch the rent calculation to apply custom multipliers per zone type. Note that
  <code>GetRentPricePerRenter</code> is a static method, making it straightforward to patch.</p>

  <pre><code class="language-csharp">[HarmonyPatch(typeof(Game.Buildings.PropertyUtils),
    nameof(PropertyUtils.GetRentPricePerRenter))]
public static class RentPricePatch
{
    public static void Postfix(ref int __result, int buildingLevel, AreaType areaType)
    {
        // 50% discount on residential rent
        if (areaType == AreaType.Residential)
        {
            __result = Mathf.RoundToInt(__result * 0.5f);
        }

        // Cap industrial rent based on level
        if (areaType == AreaType.Industrial)
        {
            int maxRent = buildingLevel * 500;
            __result = Mathf.Min(__result, maxRent);
        }
    }
}</code></pre>

  <h3>Monitor High-Rent Buildings</h3>

  <p>Find all buildings where renters are paying more than they can afford.</p>

  <pre><code class="language-csharp">public partial class RentMonitorSystem : GameSystemBase
{
    private EntityQuery _buildingQuery;

    protected override void OnCreate()
    {
        base.OnCreate();
        _buildingQuery = GetEntityQuery(
            ComponentType.ReadOnly&lt;Building&gt;(),
            ComponentType.ReadOnly&lt;Renter&gt;(),
            ComponentType.ReadOnly&lt;PrefabRef&gt;(),
            ComponentType.Exclude&lt;Deleted&gt;(),
            ComponentType.Exclude&lt;Temp&gt;()
        );
    }

    protected override void OnUpdate()
    {
        var entities = _buildingQuery.ToEntityArray(Allocator.Temp);
        int highRentCount = 0;

        for (int i = 0; i &lt; entities.Length; i++)
        {
            Entity building = entities[i];
            var renters = EntityManager.GetBuffer&lt;Renter&gt;(
                building, isReadOnly: true);

            for (int j = 0; j &lt; renters.Length; j++)
            {
                Entity renter = renters[j].m_Renter;
                if (!EntityManager.HasComponent&lt;PropertyRenter&gt;(renter))
                    continue;

                PropertyRenter pr = EntityManager
                    .GetComponentData&lt;PropertyRenter&gt;(renter);
                int money = EconomyUtils.GetResources(
                    Resource.Money,
                    EntityManager.GetBuffer&lt;Game.Economy.Resources&gt;(
                        renter, isReadOnly: true));

                if (pr.m_Rent &gt; money)
                    highRentCount++;
            }
        }

        if (highRentCount &gt; 0)
            Log.Info($"Renters with rent exceeding savings: {highRentCount}");

        entities.Dispose();
    }
}</code></pre>

  <h3>Remove Abandonment and Restore Building</h3>

  <p>The reverse of <code>LeveldownJob</code> -- programmatically removes abandonment and
  restores a building to functional state. Key components to restore:
  <code>GarbageProducer</code>, <code>MailProducer</code>, <code>ElectricityConsumer</code>,
  <code>WaterConsumer</code>. The <code>PropertyToBeOnMarket</code> tag triggers the property
  market system to re-list the building. <code>BuildingCondition.m_Condition = 0</code> gives
  the building a neutral starting state.</p>

  <pre><code class="language-csharp">public void RemoveAbandonment(EntityManager em, Entity buildingEntity)
{
    // 1. Remove abandoned status
    em.RemoveComponent&lt;Abandoned&gt;(buildingEntity);

    // 2. Reset market listing (PropertyToBeOnMarket triggers re-listing)
    em.AddComponent&lt;PropertyToBeOnMarket&gt;(buildingEntity);
    if (em.HasComponent&lt;PropertyOnMarket&gt;(buildingEntity))
        em.RemoveComponent&lt;PropertyOnMarket&gt;(buildingEntity);

    // 3. Reset building condition to zero
    em.SetComponentData(buildingEntity, new BuildingCondition { m_Condition = 0 });

    // 4. Restore utility consumers removed during abandonment
    em.AddComponentData(buildingEntity, default(GarbageProducer));
    em.AddComponentData(buildingEntity, default(MailProducer));
    em.AddComponentData(buildingEntity, default(ElectricityConsumer));
    em.AddComponentData(buildingEntity, default(WaterConsumer));

    // 5. Remove abandoned notification icon
    // (requires IconCommandBuffer from BuildingConfigurationData)
}</code></pre>

  <!-- ============================================================ -->
  <h2>Harmony Patch Points</h2>

  <h3>Candidate 1: PropertyUtils.GetRentPricePerRenter</h3>

  <table>
    <tbody>
      <tr><td><strong>Signature</strong></td><td><code>static int GetRentPricePerRenter(BuildingPropertyData, int buildingLevel, int lotSize, float landValueBase, AreaType areaType, ref EconomyParameterData, bool ignoreLandValue)</code></td></tr>
      <tr><td><strong>Patch type</strong></td><td>Prefix or Postfix</td></tr>
      <tr><td><strong>What it enables</strong></td><td>Override rent prices with custom formulas. A postfix can modify the result; a prefix can replace the entire calculation.</td></tr>
      <tr><td><strong>Risk level</strong></td><td>Low -- static utility method called from AdjustRentJob</td></tr>
      <tr><td><strong>Side effects</strong></td><td>Changes rent for all buildings. Must consider that this runs in Burst-compiled jobs (patch on managed wrapper only).</td></tr>
    </tbody>
  </table>

  <h3>Candidate 2: LandValueSystem.OnUpdate</h3>

  <table>
    <tbody>
      <tr><td><strong>Signature</strong></td><td><code>protected override void OnUpdate()</code></td></tr>
      <tr><td><strong>Patch type</strong></td><td>Prefix (skip) or Postfix (modify results)</td></tr>
      <tr><td><strong>What it enables</strong></td><td>Disable or modify land value updates entirely. A postfix could modify the cell map data after the jobs complete.</td></tr>
      <tr><td><strong>Risk level</strong></td><td>Medium -- affects the entire land value grid</td></tr>
      <tr><td><strong>Side effects</strong></td><td>Skipping updates freezes land values. Must ensure job handles are properly managed.</td></tr>
    </tbody>
  </table>

  <h3>Candidate 3: BuildingUpkeepSystem.OnUpdate</h3>

  <table>
    <tbody>
      <tr><td><strong>Signature</strong></td><td><code>protected override void OnUpdate()</code></td></tr>
      <tr><td><strong>Patch type</strong></td><td>Prefix or Postfix</td></tr>
      <tr><td><strong>What it enables</strong></td><td>Modify building condition change rates, level-up/level-down thresholds</td></tr>
      <tr><td><strong>Risk level</strong></td><td>Medium -- affects all building leveling</td></tr>
      <tr><td><strong>Side effects</strong></td><td>Could prevent buildings from ever leveling up or down</td></tr>
    </tbody>
  </table>

  <h3>Candidate 4: BuildingUtils.GetLevelingCost</h3>

  <table>
    <tbody>
      <tr><td><strong>Signature</strong></td><td><code>static int GetLevelingCost(AreaType areaType, BuildingPropertyData propertyData, int level, ref CityModifier cityModifier)</code></td></tr>
      <tr><td><strong>Patch type</strong></td><td>Postfix</td></tr>
      <tr><td><strong>What it enables</strong></td><td>Override the condition threshold required for a building to level up. A postfix can scale the cost per zone type or level to make leveling easier or harder.</td></tr>
      <tr><td><strong>Risk level</strong></td><td>Low -- static utility method, no side effects</td></tr>
      <tr><td><strong>Side effects</strong></td><td>Lowering the cost accelerates leveling city-wide; raising it slows leveling and may cause condition overflow at extreme values</td></tr>
    </tbody>
  </table>

  <h3>Candidate 5: BuildingUtils.GetAbandonCost</h3>

  <table>
    <tbody>
      <tr><td><strong>Signature</strong></td><td><code>static int GetAbandonCost(AreaType areaType, BuildingPropertyData propertyData, int level, ref CityModifier cityModifier)</code></td></tr>
      <tr><td><strong>Patch type</strong></td><td>Postfix</td></tr>
      <tr><td><strong>What it enables</strong></td><td>Override the negative condition threshold that triggers building abandonment. Raising the cost makes buildings more resilient to neglect; lowering it makes them abandon faster.</td></tr>
      <tr><td><strong>Risk level</strong></td><td>Low -- static utility method, no side effects</td></tr>
      <tr><td><strong>Side effects</strong></td><td>Extreme values can prevent abandonment entirely or cause instant abandonment</td></tr>
    </tbody>
  </table>

  <h3>Candidate 6: BuildingUtils.GetBuildingConditionChange</h3>

  <table>
    <tbody>
      <tr><td><strong>Signature</strong></td><td><code>static int GetBuildingConditionChange(BuildingConfigurationData configData, ...)</code></td></tr>
      <tr><td><strong>Patch type</strong></td><td>Postfix</td></tr>
      <tr><td><strong>What it enables</strong></td><td>Override the per-tick condition increment/decrement rate. Controls the base speed of building condition accumulation in both positive and negative directions.</td></tr>
      <tr><td><strong>Risk level</strong></td><td>Low -- static utility method</td></tr>
      <tr><td><strong>Side effects</strong></td><td>Changes affect all buildings uniformly. Combined with the exponential level scaling (<code>pow(2, level)</code>), even small changes to the base rate have amplified effects at higher building levels.</td></tr>
    </tbody>
  </table>

  <h3>Candidate 7: RentAdjustSystem.OnUpdate</h3>

  <table>
    <tbody>
      <tr><td><strong>Signature</strong></td><td><code>protected override void OnUpdate()</code></td></tr>
      <tr><td><strong>Patch type</strong></td><td>Prefix or Postfix</td></tr>
      <tr><td><strong>What it enables</strong></td><td>Override the PropertySeeker enable/disable logic, modify high rent warning thresholds</td></tr>
      <tr><td><strong>Risk level</strong></td><td>Medium -- affects renter movement decisions</td></tr>
      <tr><td><strong>Side effects</strong></td><td>May impact household/company relocation patterns</td></tr>
    </tbody>
  </table>

  <!-- ============================================================ -->
  <h2>Configuration</h2>

  <h3>Key Tuning Points</h3>

  <table>
    <thead>
      <tr><th>Parameter</th><th>Source</th><th>Default</th><th>Effect</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>Land value baseline</td>
        <td>LandValueParameterData.m_LandValueBaseline</td>
        <td>10.0</td>
        <td>Minimum land value everywhere on the map</td>
      </tr>
      <tr>
        <td>Tram/subway bonus</td>
        <td>LandValueParameterData.m_TramSubwayBonusMultiplier</td>
        <td>50.0</td>
        <td>Land value boost near tram/subway lines (highest weight of any factor)</td>
      </tr>
      <tr>
        <td>Telecom bonus</td>
        <td>LandValueParameterData.m_TelecomCoverageBonusMultiplier</td>
        <td>20.0</td>
        <td>Land value boost from internet coverage</td>
      </tr>
      <tr>
        <td>Common factor cap</td>
        <td>LandValueParameterData.m_CommonFactorMaxBonus</td>
        <td>100</td>
        <td>Maximum bonus any single factor can contribute</td>
      </tr>
      <tr>
        <td>Ground pollution penalty</td>
        <td>LandValueParameterData.m_GroundPollutionPenaltyMultiplier</td>
        <td>10.0</td>
        <td>Land value reduction from ground contamination</td>
      </tr>
      <tr>
        <td>Rent base rate</td>
        <td>EconomyParameterData.m_RentPriceBuildingZoneTypeBase</td>
        <td>float3 (per zone type)</td>
        <td>Base rent rate for residential (x), commercial (y), industrial (z)</td>
      </tr>
      <tr>
        <td>Land value modifier</td>
        <td>EconomyParameterData.m_LandValueModifier</td>
        <td>float3 (per zone type)</td>
        <td>How strongly land value affects rent per zone type</td>
      </tr>
      <tr>
        <td>Space multiplier</td>
        <td>BuildingPropertyData.m_SpaceMultiplier</td>
        <td>Varies by prefab</td>
        <td>Scales rent based on building size and density</td>
      </tr>
      <tr>
        <td>Updates per day</td>
        <td>PropertyRenterSystem.kUpdatesPerDay</td>
        <td>16</td>
        <td>How many times per day rent is collected (hardcoded)</td>
      </tr>
      <tr>
        <td>Land value update rate</td>
        <td>LandValueSystem.kUpdatesPerDay</td>
        <td>32</td>
        <td>How often the cell map is recalculated</td>
      </tr>
      <tr>
        <td>Edge lerp rate</td>
        <td>EdgeUpdateJob (hardcoded)</td>
        <td>0.6</td>
        <td>How quickly edge land values approach their target</td>
      </tr>
      <tr>
        <td>Cell lerp rate</td>
        <td>LandValueMapUpdateJob (hardcoded)</td>
        <td>0.4</td>
        <td>How quickly cell map values approach their target</td>
      </tr>
    </tbody>
  </table>

  <!-- ============================================================ -->
  <h2>Open Questions</h2>

  <ul>
    <li>
      <strong>EconomyParameterData defaults:</strong> The exact default values of
      <code>m_RentPriceBuildingZoneTypeBase</code> and <code>m_LandValueModifier</code> are set by
      the EconomyPrefab, which was not decompiled. These float3 values control the base rent rate
      and land value sensitivity per zone type (residential, commercial, industrial).
    </li>
    <li>
      <strong>Mixed building rent split:</strong> <code>m_MixedBuildingCompanyRentPercentage</code>
      controls how rent is divided in mixed-use buildings (residential + commercial). The formula
      adjusts the effective renter count: <code>residentialProperties / (1 - percentage)</code>.
      The exact default percentage is unknown.
    </li>
    <li>
      <strong>Level-up material requirements:</strong> The specific resources and quantities
      required for building level-up come from <code>ZoneLevelUpResourceData</code> buffers on
      zone prefabs or <code>BuildingConfigurationData</code>. The exact per-level costs were not
      traced.
    </li>
    <li>
      <strong>BuildingCondition rates:</strong> The actual increment and decrement values come from
      <code>BuildingConfigurationData.m_BuildingConditionDecrement</code> and
      <code>BuildingUtils.GetBuildingConditionChange()</code>. The leveling cost and abandon cost
      are computed by <code>BuildingUtils.GetLevelingCost()</code> and
      <code>BuildingUtils.GetAbandonCost()</code>, which factor in area type, building properties,
      current level, and city modifiers.
    </li>
    <li>
      <strong>ZonePropertiesData.m_IgnoreLandValue:</strong> Some zone types can opt out of land
      value in the rent formula entirely. Which zones use this flag was not determined.
    </li>
  </ul>

  <!-- ============================================================ -->
  <h2>Sources</h2>

  <ul>
    <li>Decompiled from: Game.dll -- Game.Simulation.LandValueSystem, Game.Simulation.PropertyRenterSystem, Game.Simulation.RentAdjustSystem, Game.Simulation.BuildingUpkeepSystem, Game.Simulation.PropertyRenterRemoveSystem</li>
    <li>Components: Game.Net.LandValue, Game.Simulation.LandValueCell, Game.Buildings.PropertyRenter, Game.Buildings.Renter, Game.Buildings.RentAction, Game.Buildings.RentersUpdated, Game.Buildings.PropertyOnMarket, Game.Buildings.BuildingCondition</li>
    <li>Prefab types: Game.Prefabs.LandValueParameterData, Game.Prefabs.LandValuePrefab, Game.Prefabs.BuildingPropertyData</li>
    <li>Utility: Game.Buildings.PropertyUtils (rent formula, property scoring)</li>
    <li>Related: <a href="company-simulation.html">Company Simulation</a> (profitability), <a href="citizens-households.html">Citizens &amp; Households</a> (income), <a href="demand-systems.html">Demand Systems</a> (property demand)</li>
  </ul>

  <footer>
    <p>Source: Decompiled from Game.dll (Cities: Skylines II) -- LandValueSystem, PropertyRenterSystem, RentAdjustSystem, BuildingUpkeepSystem, PropertyUtils.</p>
    <div class="attribution-footer">
      <p>This documentation was generated using Claude (Anthropic), supervised by the repository owner.</p>
    </div>
  </footer>

  </main>

</div>

</body>
</html>
